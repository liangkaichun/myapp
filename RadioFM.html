<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Radio FM</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100' width='100' height='100'><rect x='15' y='25' width='70' height='50' rx='5' fill='%23D4AF37' stroke='%23B8860B' stroke-width='2'/><circle cx='35' cy='50' r='7' fill='%238B4513' stroke='%23A0522D' stroke-width='1'/><circle cx='65' cy='50' r='7' fill='%238B4513' stroke='%23A0522D' stroke-width='1'/><rect x='78' y='45' width='17' height='10' fill='%23D4AF37' stroke='%23B8860B' stroke-width='1'/><line x1='25' y1='15' x2='25' y2='25' stroke='%23D4AF37' stroke-width='4' stroke-linecap='round'/><line x1='75' y1='15' x2='75' y2='25' stroke='%23D4AF37' stroke-width='4' stroke-linecap='round'/></svg>">
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .scrollbar-thin {
                scrollbar-width: thin;
            }
            .scrollbar-thumb-rounded {
                scrollbar-color: rgba(112, 120, 136, 0.5) rgba(160, 168, 184, 0.5);
            }
        }
    </style>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', 'Microsoft YaHei', sans-serif;
            -webkit-tap-highlight-color: transparent;
        }

        html,
        body {
            height: 100%;
            width: 100%;
            overflow: hidden;
            background: #e0e8f0;
            background-image: linear-gradient(to bottom, #f0f8ff, #d0d8e8);
        }

        body {
            -webkit-tap-highlight-color: transparent;
            outline: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 0;
        }

        p {
            display: none;
        }

        .radio-container {
            width: 100%;
            height: 100%;
            background: #c0c8d8;
            box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.3), inset 0 -5px 5px rgba(0, 0, 0, 0.1);
            border: 1px solid #a0a8b8;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            padding: 10px;
        }

        .radio-title {
            color: #404860;
            font-weight: bold;
            text-shadow: 0 1px 0 rgba(255, 255, 255, 0.3);
            font-size: 18px;
        }

        .display {
            background: #a0a8b8;
            border: 5px solid #707888;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 8px;
            box-shadow: inset 0 8px 15px rgba(0, 0, 0, 0.2), inset 0 -5px 5px rgba(255, 255, 255, 0.1);
            position: relative;
            min-height: 90px;
            height: 100px;
        }

        .station-name {
            font-size: 22px;
            font-weight: bold;
            color: #303850;
            text-shadow: 0 1px 0 rgba(255, 255, 255, 0.3);
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            cursor: pointer;
        }

        .status {
            font-size: 16px;
            color: #404860;
            font-style: italic;
        }

        .tuner {
            background: #9098a8;
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            box-shadow: inset 0 8px 15px rgba(0, 0, 0, 0.2), inset 0 -5px 5px rgba(255, 255, 255, 0.1);
        }

        .tuner-scale {
            height: 30px;
            background: #707888;
            border-radius: 5px;
            position: relative;
            margin-bottom: 10px;
        }

        .tuner-indicator {
            position: absolute;
            top: -6px;
            left: 50%;
            width: 4px;
            height: 42px;
            background: #f0f0f0;
            transform: translateX(-50%);
            box-shadow: 0 0 8px rgba(255, 255, 255, 0.8);
            z-index: 2;
        }

        .controls {
            display: flex;
            justify-content: center;
            margin-bottom: 8px;
            align-items: center;
            gap: 8px;
        }

        .control-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: #b0b8c8;
            border: none;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2), inset 0 3px 3px rgba(255, 255, 255, 0.2), inset 0 -3px 3px rgba(0, 0, 0, 0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: transform 0.1s;
        }

        .control-btn:active {
            transform: translateY(2px);
            box-shadow: inset 0 8px 15px rgba(0, 0, 0, 0.2), inset 0 -3px 3px rgba(255, 255, 255, 0.1);
        }

        .control-btn svg {
            width: 30px;
            height: 30px;
            fill: #404860;
            filter: drop-shadow(0 1px 0 rgba(255, 255, 255, 0.3));
        }

        .btn-play {
            width: 50px;
            height: 50px;
            background: #4FAAFF;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3), inset 0 3px 3px rgba(255, 255, 255, 0.3), inset 0 -3px 3px rgba(0, 0, 0, 0.3);
        }

        .btn-play svg {
            width: 30px;
            height: 30px;
            fill: #fff;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.5));
        }

        .btn-play:active {
            transform: translateY(1px);
            box-shadow: inset 0 8px 20px rgba(0, 0, 0, 0.3), inset 0 -3px 3px rgba(255, 255, 255, 0.1);
        }

        .station-list-container {
            flex: 1;
            background: #b0b8c8;
            border-radius: 10px;
            padding: 10px;
            overflow-y: auto;
            box-shadow: inset 0 8px 15px rgba(0, 0, 0, 0.2), inset 0 -5px 5px rgba(255, 255, 255, 0.1);
            display: flex;
            flex-direction: column;
        }

        .station-list-wrapper {
            flex: 1;
            overflow-y: auto;
        }

        .station-item {
            padding: 10px 12px;
            margin-bottom: 6px;
            background: #c0c8d8;
            border-radius: 8px;
            cursor: pointer;
            box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1), inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 1px solid #a0a8b8;
            transition: all 0.2s;
            position: relative;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .station-item:active {
            background: #4FAAFF;
            transform: translateY(2px);
        }

        .station-item.active {
            background: #4FAAFF;
            color: #fff;
            border-color: #80a0d0;
        }

        .station-item-name {
            font-weight: bold;
            color: #404860;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            font-size: 16px;
            flex: 1;
        }

        .station-item.active .station-item-name {
            color: #fff;
            text-shadow: 0 1px 1px rgba(0, 0, 0, 0.3);
        }

        .station-item-playing {
            display: none !important;
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: #f00;
            border-radius: 50%;
            box-shadow: 0 0 8px rgba(255, 0, 0, 0.5);
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% {
                opacity: 0.6;
            }

            50% {
                opacity: 1;
            }

            100% {
                opacity: 0.6;
            }
        }

        .panel-btn {
            padding: 2px;
            background: #b0b8c8;
            border: none;
            border-radius: 5px;
            color: #404860;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            text-align: center;
            box-shadow: 0 2px 3px rgba(0, 0, 0, 0.2), inset 0 1px 1px rgba(255, 255, 255, 0.2);
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            width: calc(15% - 10px);
            min-width: 0;
            height: 36px;
        }

        .panel-btn svg {
            width: 12px;
            height: 12px;
            margin-right: 3px;
            fill: currentColor;
        }

        .panel-btn:active {
            transform: translateY(1px);
            box-shadow: inset 0 2px 3px rgba(0, 0, 0, 0.2);
        }

        .panel-btn.active {
            background: #4FAAFF;
            color: #fff;
        }

        /* 搜索框样式修改 */
        .search-container {
            position: relative;
            margin-bottom: 10px;
        }

        .search-box {
            padding: 8px 30px 8px 8px; /* 右侧留出空间给清除图标 */
            background: #b0b8c8;
            border: 1px solid #a0a8b8;
            border-radius: 5px;
            color: #404860;
            font-size: 14px;
            width: 100%;
            box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        .clear-search {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            cursor: pointer;
            display: none;
            font-size: 20px;
            color: #707888;
        }

        .timer-container {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 100;
            justify-content: center;
            align-items: center;
        }

        .timer-box {
            background: #c0c8d8;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            width: 300px;
            max-width: 90%;
        }

        .timer-title {
            font-size: 18px;
            font-weight: bold;
            color: #404860;
            margin-bottom: 15px;
            text-align: center;
        }

        .timer-options {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin-bottom: 15px;
        }

        .timer-option {
            margin-bottom: 8px;
            justify-content: center;
        }

        .timer-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #a0a8b8;
            border-radius: 5px;
            background: #b0b8c8;
            color: #404860;
        }

        .timer-buttons {
            display: flex;
            justify-content: space-between;
        }

        .timer-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            width: 90px;
        }

        .timer-set {
            background: #4FAAFF;
            color: #fff;
        }

        .timer-cancel {
            background: #b0b8c8;
            color: #404860;
        }

        .favorite-btn {
            background: none;
            border: none;
            color: #a0a8b8;
            font-size: 16px;
            cursor: pointer;
            margin-left: 8px;
            padding: 0 5px;
            font-style: normal;
        }

        .station-item.active .favorite-btn {
            color: #fff;
        }

        .favorite-btn.favorited {
            color: gold;
        }

        /* 滚动条样式 */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: #a0a8b8;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb {
            background: #707888;
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #606878;
        }
    </style>
    <!-- 引入 hls.js 库 -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
</head>

<body>
    <div class="radio-container">
        <div class="display">
            <div class="station-name" id="current-station"></div>
            <div class="status" id="status"></div>
        </div>

        <div class="controls">
            <button class="panel-btn active" id="btn-show-all">
                <svg viewBox="0 0 24 24">
                    <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path>
                </svg>
                <span>全部</span>
            </button>
            <button class="panel-btn" id="btn-show-favorites">
                <svg viewBox="0 0 24 24">
                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path>
                </svg>
                <span>收藏</span>
            </button>
            <button class="control-btn" id="btn-prev">
                <svg viewBox="0 0 24 24">
                    <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"></path>
                </svg>
            </button>
            <button class="control-btn btn-play" id="btn-play">
                <svg viewBox="0 0 24 24" id="play-icon">
                    <path d="M8 5v14l11-7z"></path>
                </svg>
            </button>
            <button class="control-btn" id="btn-next">
                <svg viewBox="0 0 24 24">
                    <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"></path>
                </svg>
            </button>
            <button class="panel-btn" id="btn-timer">
                <svg viewBox="0 0 24 24">
                    <path d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42C16.07 4.74 14.12 4 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9 9-4.03 9-9c0-2.12-.74-4.07-1.97-5.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>
                </svg>
                <span>定时</span>
            </button>
            <button class="panel-btn" id="btn-open-m3u">
                <svg viewBox="0 0 24 24">
                    <path d="M20 6H12L10 4H4C2.9 4 2 4.9 2 6V18C2 19.1 2.9 20 4 20H20C21.1 20 22 19.1 22 18V8C22 6.9 21.1 6 20 6Z"></path>
                </svg>
                <span>打开</span>
            </button>
        </div>

        <div class="station-list-container">
            <!-- 使用新的搜索容器 -->
            <div class="search-container">
                <input type="text" class="search-box" id="search-box" placeholder="搜索...">
                <span class="clear-search" id="clear-search">&times;</span>
            </div>
            <div class="station-list-wrapper" id="station-list">

            </div>
        </div>
    </div>

    <audio id="audio-player" preload="none"></audio>

    <!-- 定时器弹出框 -->
    <div class="timer-container" id="timer-container">
        <div class="timer-box">
            <div class="timer-title">定时关闭</div>
            <div class="timer-options">
                <div class="timer-option">
                    <button class="timer-btn timer-option-btn" data-minutes="30">30分钟</button>
                </div>
                <div class="timer-option">
                    <button class="timer-btn timer-option-btn" data-minutes="60">60分钟</button>
                </div>
                <div class="timer-option">
                    <button class="timer-btn timer-option-btn" data-minutes="90">90分钟</button>
                </div>
                <div class="timer-option">
                    <button class="timer-btn timer-option-btn" data-minutes="120">120分钟</button>
                </div>
            </div>
            <div style="margin-bottom: 15px;">
                <input type="number" class="timer-input" id="custom-time" placeholder="自定义" min="1">
            </div>
            <div class="timer-buttons">
                <button class="timer-btn timer-cancel" id="timer-cancel">取消</button>
                <button class="timer-btn timer-set" id="timer-set">设置</button>
            </div>
        </div>
    </div>

    <!-- M3u文件选择弹出框 -->
    <div class="timer-container" id="m3u-select-container">
        <div class="timer-box">
            <div class="timer-title">选择m3u文件</div>
            <div style="margin-bottom: 10px;">
                <label for="m3u-url-input" style="font-size:14px;display:block;margin-bottom:5px;">在线M3U URL:</label>
                <input type="url" id="m3u-url-input" placeholder="http://kaichun.net/radio.m3u" style="width:100%;padding:8px;border:1px solid #a0a8b8;border-radius:5px;background:#b0b8c8;color:#404860;">
            </div>
            <div style="margin-bottom: 10px;">
                <label for="m3u-file-input" style="font-size:14px;display:block;margin-bottom:5px;">本地M3U文件:</label>
                <input type="file" id="m3u-file-input" accept=".m3u,.csv">
            </div>
            <div style="margin-bottom: 10px;">
                <input type="checkbox" id="default-load-checkbox">
                <label for="default-load-checkbox" style="font-size:14px">启动时自动加载</label>
            </div>
            <div class="timer-buttons">
                <button class="timer-btn timer-cancel" id="m3u-cancel">取消</button>
                <button class="timer-btn timer-set" id="m3u-confirm">确认</button>
            </div>
        </div>
    </div>

    <script>
        // 内置电台数据
        let radioData = ["CCTV1综合,https://piccpndali.v.myalicdn.com/audio/cctv1_2.m3u8",
            "CCTV2财经,https://piccpndali.v.myalicdn.com/audio/cctv2_2.m3u8",
            "CCTV3综艺,https://piccpndali.v.myalicdn.com/audio/cctv3_2.m3u8",
            "CCTV4国际,https://piccpndali.v.myalicdn.com/audio/cctv4_2.m3u8",
            "CCTV4国际美洲,https://piccpndali.v.myalicdn.com/audio/cctvamerica_2.m3u8",
            "CCTV4国际欧洲,https://piccpndali.v.myalicdn.com/audio/cctveurope_2.m3u8",
            "CCTV5+体育,https://piccpndali.v.myalicdn.com/audio/cctv5plus_2.m3u8",
            "CCTV5体育,https://piccpndali.v.myalicdn.com/audio/cctv5_2.m3u8",
            "CCTV6电影,https://piccpndali.v.myalicdn.com/audio/cctv6_2.m3u8",
            "CCTV7国防军事,https://piccpndali.v.myalicdn.com/audio/cctv7_2.m3u8",
            "CCTV8电视剧,https://piccpndali.v.myalicdn.com/audio/cctv8_2.m3u8",
            "CCTV9纪录,https://piccpndali.v.myalicdn.com/audio/cctv9_2.m3u8",
            "CCTV10科教,https://piccpndali.v.myalicdn.com/audio/cctv10_2.m3u8",
            "CCTV11戏曲,https://piccpndali.v.myalicdn.com/audio/cctv11_2.m3u8",
            "CCTV12社会与法,https://piccpndali.v.myalicdn.com/audio/cctv12_2.m3u8",
            "CCTV13新闻,https://piccpndali.v.myalicdn.com/audio/cctv13_2.m3u8",
            "CCTV14少儿,https://piccpndks.v.kcdnvip.com/audio/cctv14_2/index.m3u8",
            "CCTV-14少儿,https://piccpndali.v.myalicdn.com/audio/cctv14_2.m3u8",
            "CCTV15音乐,https://piccpndks.v.kcdnvip.com/audio/cctv15_2/index.m3u8",
            "CCTV-15音乐,https://piccpndali.v.myalicdn.com/audio/cctv15_2.m3u8",
            "CCTV16奥林匹克,https://piccpndks.v.kcdnvip.com/audio/cctv16_2/index.m3u8",
            "CCTV-16奥林匹克,https://piccpndali.v.myalicdn.com/audio/cctv16_2.m3u8",
            "CCTV17农业农村,https://piccpndks.v.kcdnvip.com/audio/cctv17_2/index.m3u8",
            "CCTV-17农业农村,https://piccpndali.v.myalicdn.com/audio/cctv17_2.m3u8",
            "CETV1,https://piccpndali.v.myalicdn.com/audio/cetv1_2.m3u8",
            "CETV2,https://piccpndali.v.myalicdn.com/audio/cetv2_2.m3u8",
            "CETV3,https://piccpndali.v.myalicdn.com/audio/cetv3_2.m3u8",
            "CETV4,https://piccpndali.v.myalicdn.com/audio/cetv4_2.m3u8",
            "安徽卫视,https://piccpndali.v.myalicdn.com/audio/anhui_2.m3u8",
            "北京卫视,https://piccpndali.v.myalicdn.com/audio/btv1_2.m3u8",
            "重庆卫视,https://piccpndali.v.myalicdn.com/audio/chongqing_2.m3u8",
            "第一财经,https://a1live.livecdn.yicai.com/live/radio_tv.m3u8",
            "东方卫视,https://piccpndali.v.myalicdn.com/audio/dongfang_2.m3u8",
            "东南卫视,https://piccpndali.v.myalicdn.com/audio/dongnan_2.m3u8",
            "凤凰中文,https://playtv-live.ifeng.com/live/06OLEGEGM4G_audio.m3u8",
            "凤凰资讯,https://playtv-live.ifeng.com/live/06OLEEWQKN4_audio.m3u8",
            "甘肃卫视,https://piccpndali.v.myalicdn.com/audio/gansu_2.m3u8",
            "广东卫视,https://piccpndali.v.myalicdn.com/audio/guangdong_2.m3u8",
            "广西卫视,https://piccpndali.v.myalicdn.com/audio/guangxi_2.m3u8",
            "贵州卫视,https://piccpndali.v.myalicdn.com/audio/guizhou_2.m3u8",
            "海南卫视,https://piccpndali.v.myalicdn.com/audio/travel_2.m3u8",
            "河北卫视,https://satellitepull.cnr.cn/live/wxhebws/playlist.m3u8",
            "河南卫视,https://piccpndali.v.myalicdn.com/audio/henan_2.m3u8",
            "黑龙江卫视,https://piccpndali.v.myalicdn.com/audio/heilongjiang_2.m3u8",
            "湖北卫视,https://piccpndali.v.myalicdn.com/audio/hubei_2.m3u8",
            "湖南卫视,https://satellitepull.cnr.cn/live/wx32hunws/playlist.m3u8",
            "吉林卫视,https://satellitepull.cnr.cn/live/wxjlws/playlist.m3u8",
            "江苏卫视,https://satellitepull.cnr.cn/live/wx32jsws/playlist.m3u8",
            "江西卫视,https://piccpndali.v.myalicdn.com/audio/jiangxi_2.m3u8",
            "辽宁卫视,https://piccpndali.v.myalicdn.com/audio/liaoning_2.m3u8",
            "内蒙古卫视,https://piccpndali.v.myalicdn.com/audio/neimenggu_2.m3u8",
            "宁夏卫视,https://piccpndali.v.myalicdn.com/audio/ningxia_2.m3u8",
            "青海卫视,https://piccpndali.v.myalicdn.com/audio/qinghai_2.m3u8",
            "山东卫视,https://piccpndali.v.myalicdn.com/audio/shandong_2.m3u8",
            "山西卫视,https://piccpndali.v.myalicdn.com/audio/shan1xi_2.m3u8",
            "陕西卫视,https://piccpndali.v.myalicdn.com/audio/shan3xi_2.m3u8",
            "深圳卫视,https://satellitepull.cnr.cn/live/wxszws/playlist.m3u8",
            "四川卫视,https://piccpndali.v.myalicdn.com/audio/sichuan_2.m3u8",
            "天津卫视,https://piccpndali.v.myalicdn.com/audio/tianjin_2.m3u8",
            "西藏卫视,https://piccpndali.v.myalicdn.com/audio/xizang_2.m3u8",
            "新疆卫视,https://piccpndali.v.myalicdn.com/audio/xinjiang_2.m3u8",
            "香港卫视,https://piccpndks.v.kcdnvip.com/audio/xianggangweishi_2.m3u8",
            "延边卫视,https://satellitepull.cnr.cn/live/wxybws/playlist.m3u8",
            "云南卫视,https://piccpndali.v.myalicdn.com/audio/yunnan_2.m3u8",
            "浙江卫视,https://satellitepull.cnr.cn/live/wxzjws/playlist.m3u8",
            "BTV财经,https://wstvcpudali.v.myalicdn.com/wstvcpud/udrmbtv5_1/index.m3u8?adapt=0&BR=audio",
            "BTV科教,https://wstvcpudali.v.myalicdn.com/wstvcpud/udrmbtv3_1/index.m3u8?adapt=0&BR=audio",
            "BTV生活,https://wstvcpudali.v.myalicdn.com/wstvcpud/udrmbtv7_1/index.m3u8?adapt=0&BR=audio",
            "BTV文艺,https://wstvcpudali.v.myalicdn.com/wstvcpud/udrmbtv2_1/index.m3u8?adapt=0&BR=audio",
            "BTV新闻,https://wstvcpudali.v.myalicdn.com/wstvcpud/udrmbtv9_1/index.m3u8?adapt=0&BR=audio",
            "BTV影视,https://wstvcpudali.v.myalicdn.com/wstvcpud/udrmbtv4_1/index.m3u8?adapt=0&BR=audio",
            "浙江国际伴音,https://ali-vl.cztv.com/channels/lantian/channel010/360p.m3u8",
            "浙江经济伴音,https://ali-vl.cztv.com/channels/lantian/channel003/360p.m3u8",
            "浙江民生伴音,https://ali-vl.cztv.com/channels/lantian/channel006/360p.m3u8",
            "浙江卫视伴音,https://ali-vl.cztv.com/channels/lantian/channel001/360p.m3u8",
            "浙江新闻伴音,https://ali-vl.cztv.com/channels/lantian/channel007/360p.m3u8",
            "浙江影视伴音,https://ali-vl.cztv.com/channels/lantian/channel004/360p.m3u8",
            "钱江都市伴音,https://ali-vl.cztv.com/channels/lantian/channel002/360p.m3u8",
            "之江纪录伴音,https://ali-vl.cztv.com/channels/lantian/channel012/360p.m3u8",
            "CNR中国之声,https://satellitepull.cnr.cn/live/wxzgzs/playlist.m3u8",
            "CNR经济之声,https://satellitepull.cnr.cn/live/wxjjzs/playlist.m3u8",
            "CNR音乐之声,https://satellitepull.cnr.cn/live/wxyyzs/playlist.m3u8",
            "CNR经典音乐广播,https://satellitepull.cnr.cn/live/wxdszs/playlist.m3u8",
            "CNR台海之声,https://satellitepull.cnr.cn/live/wxzhzs/playlist.m3u8",
            "CNR神州之声,https://satellitepull.cnr.cn/live/wxszzs/playlist.m3u8",
            "CNR大湾区之声,https://satellitepull.cnr.cn/live/wxhxzs/playlist.m3u8",
            "CNR民族之声,https://satellitepull.cnr.cn/live/wxmzzs/playlist.m3u8",
            "CNR文艺之声,https://satellitepull.cnr.cn/live/wxwyzs/playlist.m3u8",
            "CNR老年之声,https://satellitepull.cnr.cn/live/wxlnzs/playlist.m3u8",
            "CNR藏语广播,https://satellitepull.cnr.cn/live/wxzygb/playlist.m3u8",
            "CNR阅读之声,https://satellitepull.cnr.cn/live/wxylgb/playlist.m3u8",
            "CNR维语广播,https://satellitepull.cnr.cn/live/wxwygb/playlist.m3u8",
            "CNR香港之声,https://satellitepull.cnr.cn/live/wxxgzs/playlist.m3u8",
            "CNR中国交通广播,https://satellitepull.cnr.cn/live/wxzgjtgb/playlist.m3u8?wsSession=28e11e3debee46427a9d53dc-174908170190549&wsIPSercert=f7b6cfa8467acd0836b62cf14aa786d3",
            "CNR乡村之声,https://satellitepull.cnr.cn/live/wxxczs/playlist.m3u8",
            "CNR哈语广播,https://satellitepull.cnr.cn/live/wxhygb/playlist.m3u8",
            "Hit FM,https://sk.cri.cn/887.m3u8",
            "环球资讯,https://sk.cri.cn/905.m3u8",
            "南海之声,https://sk.cri.cn/nhzs.m3u8",
            "轻松调频,https://sk.cri.cn/915.m3u8",
            "CGTN,https://sk.cri.cn/am846.m3u8",
            "世界华声华语环球方言广播,https://sk.cri.cn/hxfh.m3u8",
            "华语环球广播,https://sk.cri.cn/hyhq.m3u8",
            "FM1068,https://lhttp.qtfm.cn/live/20211622/64k.mp3",
            "FM977,https://lhttp.qtfm.cn/live/1212/64k.mp3",
            "FM994,https://lhttp.qtfm.cn/live/5022134/64k.mp3",
            "HD音乐台,https://lhttp.qingting.fm/live/15318341/64k.mp3",
            "Hit-FM台北之音广播,http://202.39.43.67:1935/live/RA000036/chunklist.m3u8",
            "Hot100-Uncensored,https://das-edge14-live365-dal02.cdnstream.com/a36860_2",
            "阿基米德故事会,https://lhttp.qingting.fm/live/20500182/64k.mp3",
            "北京城市广播,https://lhttp.qtfm.cn/live/345/64k.mp3",
            "北京人民广播,https://lhttp.qtfm.cn/live/4665/64k.mp3",
            "北京文艺广播,https://lhttp.qtfm.cn/live/333/64k.mp3",
            "北京新闻广播,https://lhttp.qtfm.cn/live/339/64k.mp3",
            "北京音乐广播,https://lhttp.qtfm.cn/live/332/64k.mp3",
            "北宜产业电台,http://cast.uforadio.com.tw:8000/ilan - stream",
            "滨海综合广播,https://lhttp.qtfm.cn/live/5022660/64k.mp3",
            "潮州之声,http://59.120.255.170:8081/",
            "城市广播,http://fm929.cityfm.tw:8080/929.mp3",
            "城市广播网-大苗栗广播,https://fm983.cityfm.com.tw:8083/983",
            "城市广播网-南投广播,https://fm997.cityfm.com.tw:8083/997",
            "城市广播网-台南知音,http://fm971.cityfm.tw:8080/971.mp3",
            "大树下电台,http://60.250.148.112:8000/live",
            "Danzhou新闻网,https://n10.rcs.revma.com/pntx1639ntzuv",
            "第一财经广播,https://lhttp.qtfm.cn/live/276/64k.mp3",
            "电声电台,http://59.120.102.91:8000/OnAir",
            "东上海之声,https://lhttp.qtfm.cn/live/21355/64k.mp3",
            "动听音乐台,https://lhttp.qingting.fm/live/5022107/64k.mp3",
            "凤凰中文台,https://playtv-live.ifeng.com/live/06OLEGEGM4G_audio.m3u8",
            "凤凰资讯台,https://playtv-live.ifeng.com/live/06OLEEWQKN4_audio.m3u8",
            "Gemalan广播电台,http://61.220.209.152:8081/",
            "古典音乐台,http://59.120.88.155:8000/live.mp3",
            "光华之声,http://202.39.43.67:1935/live/RA000077/playlist.m3u8",
            "广西经济广播,https://stream.bbrtv.com:10443/hls/wrr24LJGR/wrr24LJGR_live.m3u8",
            "广西文艺广播,https://stream.bbrtv.com:10443/hls/rCjJ4Y1MR/rCjJ4Y1MR_live.m3u8",
            "广西综合广播,https://stream.bbrtv.com:10443/hls/sIoyCf1Gg/sIoyCf1Gg_live.m3u8",
            "哈尔滨经济广播,https://lhttp.qtfm.cn/live/837/64k.mp3",
            "哈尔滨音乐广播,https://lhttp.qtfm.cn/live/839/64k.mp3",
            "Handan综合广播,https://lhttp.qtfm.cn/live/20211577/64k.mp3",
            "汉声调频,http://202.39.43.67:1935/live/RA000076/chunklist.m3u8",
            "汉声中波,http://202.39.43.67:1935/live/RA000074/chunklist.m3u8",
            "和谐综合广播,https://lhttp.qtfm.cn/live/5022252/64k.mp3",
            "武汉经济广播,https://lhttp.qtfm.cn/live/20200/64k.mp3",
            "武汉新闻广播,https://lhttp.qtfm.cn/live/20198/64k.mp3",
            "楚天音乐广播,https://lhttp.qtfm.cn/live/1289/64k.mp3",
            "河北好人频道广播,https://lhttp.qtfm.cn/live/1291/64k.mp3",
            "河北经济广播电台,https://lhttp.qtfm.cn/live/1295/64k.mp3",
            "河北之声广播,https://lhttp.qtfm.cn/live/1303/64k.mp3",
            "河南经济广播,https://stream.hndt.com/live/jingji/playlist.m3u8",
            "河南卫视伴音,https://piccpndali.v.myalicdn.com/audio/henan_2.m3u8",
            "河南新闻广播,https://lhttp.qtfm.cn/live/20208/64k.mp3",
            "河南音乐广播,https://stream.hndt.com/live/yinyue/playlist.m3u8",
            "河南影视广播,https://stream.hndt.com/live/yingshi/playlist.m3u8",
            "黑龙江生活广播,https://lhttp.qtfm.cn/live/4970/64k.mp3",
            "黑龙江新闻广播,https://lhttp.qtfm.cn/live/4974/64k.mp3",
            "黑龙江音乐广播,https://lhttp.qtfm.cn/live/4969/64k.mp3",
            "湖北城市之声,https://lhttp.qtfm.cn/live/4671/64k.mp3",
            "华语-HITS,https://das-edge11-live365-dal03.cdnstream.com/a57743_2",
            "济南文艺广播,http://lhttp.qingting.fm/live/1670/64k.mp3",
            "佳木斯文艺交通广播,https://lhttp.qtfm.cn/live/20500022/64k.mp3",
            "嘉义环球广播,http://60.248.53.115:8081/",
            "中广igo531,https://stream.rcs.revma.com/1qxn2vg3qtzuv",
            "中广流行网ilikeRadio,https://stream.rcs.revma.com/s1zttsg3qtzuv",
            "中广新闻网BCCNewsRadio,https://stream.rcs.revma.com/fgtx07f3qtzuv",
            "中广音乐网iRadio,https://stream.rcs.revma.com/ks4vsmg3qtzuv",
            "上海动感101,https://lhttp.qtfm.cn/live/274/64k.mp3",
            "上海沸点100音乐广播,https://lhttp.qtfm.cn/live/5022341/64k.mp3",
            "上海经典947,https://lhttp.qtfm.cn/live/267/64k.mp3",
            "上海流行音乐LoveRadio,https://lhttp.qtfm.cn/live/273/64k.mp3",
            "上海新闻广播,https://lhttp.qtfm.cn/live/270/64k.mp3",
            "台北流行音乐广播,http://202.39.43.67:1935/live/RA000080/chunklist.m3u8",
        ].join('\\');

        document.addEventListener('DOMContentLoaded', function () {
            // 获取DOM元素
            const audioPlayer = document.getElementById('audio-player');
            const btnPlay = document.getElementById('btn-play');
            const playIcon = document.getElementById('play-icon');
            const btnPrev = document.getElementById('btn-prev');
            const btnNext = document.getElementById('btn-next');
            const btnTimer = document.getElementById('btn-timer');
            const timerContainer = document.getElementById('timer-container');
            const timerCancel = document.getElementById('timer-cancel');
            const timerSet = document.getElementById('timer-set');
            const timerOptions = document.querySelectorAll('.timer-option-btn');
            const customTimeInput = document.getElementById('custom-time');
            const currentStationElement = document.getElementById('current-station');
            const statusElement = document.getElementById('status');
            const stationListElement = document.getElementById('station-list');
            const btnShowAll = document.getElementById('btn-show-all');
            const btnShowFavorites = document.getElementById('btn-show-favorites');
            const btnOpenM3u = document.getElementById('btn-open-m3u');
            const m3uSelectContainer = document.getElementById('m3u-select-container');
            const m3uFileInput = document.getElementById('m3u-file-input');
            const m3uUrlInput = document.getElementById('m3u-url-input');
            const m3uCancelBtn = document.getElementById('m3u-cancel');
            const m3uConfirmBtn = document.getElementById('m3u-confirm');
            const defaultLoadCheckbox = document.getElementById('default-load-checkbox');
            const searchBox = document.getElementById('search-box');
            const clearSearch = document.getElementById('clear-search');

            // 变量初始化
            let stations = [];
            let currentStationIndex = -1;
            let isPlaying = false;
            let timerId = null;
            let hls = null;
            let favorites = JSON.parse(localStorage.getItem('radioFavorites')) || [];
            let currentView = 'all';
            let defaultM3uFile = JSON.parse(localStorage.getItem('defaultM3uFile')) || null;

            // 解析电台数据
            function parseStations(data) {
                return data.split('\\').map(item => {
                    const [name, url] = item.split(',');
                    return { name: name || '未知电台', url: url || '' };
                }).filter(station => station.url);
            }

            // 渲染电台列表
            function renderStationList(filteredStations = null) {
                const stationsToRender = filteredStations || 
                    (currentView === 'favorites' ? stations.filter(station => 
                        favorites.includes(station.url)
                    ) : stations);

                stationListElement.innerHTML = '';

                if (stationsToRender.length === 0) {
                    const emptyItem = document.createElement('div');
                    emptyItem.className = 'station-item';
                    emptyItem.style.textAlign = 'center';
                    emptyItem.style.pointerEvents = 'none';
                    emptyItem.innerHTML = '<span class="station-item-name">没有找到电台</span>';
                    stationListElement.appendChild(emptyItem);
                    return;
                }

                stationsToRender.forEach((station, index) => {
                    const isActive = currentStationIndex !== -1 && 
                        stations[currentStationIndex].url === station.url;
                    
                    const isFavorite = favorites.includes(station.url);
                    
                    const stationItem = document.createElement('div');
                    stationItem.className = `station-item ${isActive ? 'active' : ''}`;
                    stationItem.innerHTML = `
                        <span class="station-item-name">${station.name}</span>
                        <button class="favorite-btn ${isFavorite ? 'favorited' : ''}" data-url="${station.url}">★</button>
                    `;
                    
                    stationItem.addEventListener('click', (e) => {
                        if (!e.target.classList.contains('favorite-btn')) {
                            const originalIndex = stations.findIndex(s => s.url === station.url);
                            if (originalIndex !== -1) {
                                playStation(originalIndex);
                            }
                        }
                    });
                    
                    const favoriteBtn = stationItem.querySelector('.favorite-btn');
                    favoriteBtn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        toggleFavorite(station.url);
                    });
                    
                    stationListElement.appendChild(stationItem);
                });
            }

            // 切换收藏状态
            function toggleFavorite(url) {
                const index = favorites.indexOf(url);
                if (index === -1) {
                    favorites.push(url);
                } else {
                    favorites.splice(index, 1);
                }
                localStorage.setItem('radioFavorites', JSON.stringify(favorites));
                renderStationList();
            }

            // 播放指定电台
            function playStation(index) {
                if (index < 0 || index >= stations.length) return;

                currentStationIndex = index;
                const station = stations[index];
                
                // 更新UI
                currentStationElement.textContent = station.name;
                statusElement.textContent = '正在连接...';
                renderStationList();

                // 停止当前播放
                stopPlayback();

                // 开始新播放
                const url = station.url;
                audioPlayer.src = url;

                // 处理HLS流
                if (url.includes('.m3u8') && Hls.isSupported()) {
                    hls = new Hls();
                    hls.loadSource(url);
                    hls.attachMedia(audioPlayer);
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        audioPlayer.play().catch(error => {
                            console.error('播放失败:', error);
                            statusElement.textContent = '播放失败，请重试';
                        });
                    });
                    hls.on(Hls.Events.ERROR, function(event, data) {
                        console.error('HLS错误:', data);
                        statusElement.textContent = '播放错误: ' + data.type;
                        if (data.fatal) {
                            switch(data.type) {
                                case Hls.ErrorTypes.NETWORK_ERROR:
                                    hls.startLoad();
                                    break;
                                case Hls.ErrorTypes.MEDIA_ERROR:
                                    hls.recoverMediaError();
                                    break;
                                default:
                                    destroyHls();
                                    break;
                            }
                        }
                    });
                } else if (audioPlayer.canPlayType('application/vnd.apple.mpegurl')) {
                    // Safari直接支持HLS
                    audioPlayer.src = url;
                    audioPlayer.addEventListener('loadedmetadata', function() {
                        audioPlayer.play().catch(error => {
                            console.error('播放失败:', error);
                            statusElement.textContent = '播放失败，请重试';
                        });
                    });
                } else {
                    // 普通音频流
                    audioPlayer.play().catch(error => {
                        console.error('播放失败:', error);
                        statusElement.textContent = '播放失败，请重试';
                    });
                }

                // 更新播放状态
                isPlaying = true;
                playIcon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>';
            }

            // 停止播放
            function stopPlayback() {
                isPlaying = false;
                audioPlayer.pause();
                audioPlayer.src = '';
                destroyHls();
                playIcon.innerHTML = '<path d="M8 5v14l11-7z"></path>';
            }

            // 销毁HLS实例
            function destroyHls() {
                if (hls) {
                    hls.destroy();
                    hls = null;
                }
            }

            // 切换播放/暂停
            function togglePlayPause() {
                if (stations.length === 0) {
                    statusElement.textContent = '没有可用电台';
                    return;
                }

                if (isPlaying) {
                    audioPlayer.pause();
                    isPlaying = false;
                    playIcon.innerHTML = '<path d="M8 5v14l11-7z"></path>';
                    statusElement.textContent = '已暂停';
                } else {
                    if (currentStationIndex === -1) {
                        // 如果没有选中的电台，播放第一个
                        playStation(0);
                    } else {
                        audioPlayer.play().catch(error => {
                            console.error('播放失败:', error);
                            statusElement.textContent = '播放失败，请重试';
                        });
                        isPlaying = true;
                        playIcon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>';
                        statusElement.textContent = '正在播放';
                    }
                }
            }

            // 播放上一个电台
            function playPreviousStation() {
                if (stations.length === 0) return;
                
                currentStationIndex = (currentStationIndex - 1 + stations.length) % stations.length;
                playStation(currentStationIndex);
            }

            // 播放下一个电台
            function playNextStation() {
                if (stations.length === 0) return;
                
                currentStationIndex = (currentStationIndex + 1) % stations.length;
                playStation(currentStationIndex);
            }

            // 设置定时关闭
            function setTimer(minutes) {
                clearTimer();
                
                const milliseconds = minutes * 60 * 1000;
                timerId = setTimeout(() => {
                    stopPlayback();
                    statusElement.textContent = '已定时关闭';
                    timerContainer.style.display = 'none';
                }, milliseconds);
                
                statusElement.textContent = `将在 ${minutes} 分钟后关闭`;
                timerContainer.style.display = 'none';
            }

            // 清除定时
            function clearTimer() {
                if (timerId) {
                    clearTimeout(timerId);
                    timerId = null;
                    statusElement.textContent = '定时已取消';
                }
            }

            // 加载在线M3U文件
            function loadOnlineM3U(url, shouldDefaultLoad) {
                statusElement.textContent = '正在加载在线M3U文件...';
                
                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            throw new Error(`HTTP错误: ${response.status}`);
                        }
                        return response.text();
                    })
                    .then(content => {
                        processM3UContent(content, shouldDefaultLoad, true, url);
                        statusElement.textContent = '在线M3U文件加载成功';
                    })
                    .catch(error => {
                        console.error('加载在线M3U失败:', error);
                        statusElement.textContent = `加载失败: ${error.message}`;
                    });
            }

            // 处理M3U内容
            function processM3UContent(content, shouldDefaultLoad, isOnline = false, url = '') {
                const lines = content.split('\n');
                let newRadioData = [];
                
                // 处理CSV格式
                if (m3uFileInput.files[0]?.type === 'text/csv' && !isOnline) {
                    for (let i = 0; i < lines.length; i++) {
                        const parts = lines[i].split(',');
                        if (parts.length >= 2) {
                            const name = parts[0].trim();
                            const url = parts[1].trim();
                            try {
                                new URL(url);
                                if (name && url) {
                                    newRadioData.push(`${name},${url}`);
                                }
                            } catch (e) {
                                continue;
                            }
                        }
                    }
                } 
                // 处理M3U格式
                else {
                    for (let i = 0; i < lines.length; i++) {
                        if (lines[i].startsWith('#EXTINF:')) {
                            const name = lines[i].split(',')[1]?.trim();
                            const url = lines[i + 1]?.trim();
                            if (name && url) {
                                newRadioData.push(`${name},${url}`);
                                i++; // 跳过下一行的URL
                            }
                        } else if (!lines[i].startsWith('#') && lines[i].trim() !== '') {
                            // 处理没有EXTINF标签的URL
                            try {
                                new URL(lines[i].trim());
                                newRadioData.push(`未知电台,${lines[i].trim()}`);
                            } catch (e) {
                                continue;
                            }
                        }
                    }
                }
                
                if (newRadioData.length > 0) {
                    radioData = newRadioData.join('\\');
                    stations = parseStations(radioData);
                    currentStationIndex = -1;
                    renderStationList();
                    statusElement.textContent = `已加载 ${newRadioData.length} 个电台`;
                } else {
                    statusElement.textContent = '未找到有效的电台信息';
                }
                
                // 保存默认加载设置
                if (shouldDefaultLoad) {
                    const defaultConfig = {
                        type: isOnline ? 'url' : 'file',
                        value: isOnline ? url : content // 对于文件，我们保存内容而不是路径（浏览器安全限制）
                    };
                    localStorage.setItem('defaultM3uFile', JSON.stringify(defaultConfig));
                } else if (defaultM3uFile) {
                    // 如果取消默认加载，清除保存的设置
                    localStorage.removeItem('defaultM3uFile');
                    defaultM3uFile = null;
                }
            }

            // 搜索电台
            function searchStations(query) {
                if (!query.trim()) {
                    renderStationList();
                    return;
                }
                
                const filtered = stations.filter(station => 
                    station.name.toLowerCase().includes(query.toLowerCase())
                );
                
                renderStationList(filtered);
            }

            // 事件监听
            btnPlay.addEventListener('click', togglePlayPause);
            btnPrev.addEventListener('click', playPreviousStation);
            btnNext.addEventListener('click', playNextStation);

            // 定时器相关
            btnTimer.addEventListener('click', () => {
                timerContainer.style.display = 'flex';
                customTimeInput.value = '';
            });

            timerCancel.addEventListener('click', () => {
                timerContainer.style.display = 'none';
                clearTimer();
            });

            timerSet.addEventListener('click', () => {
                const customTime = parseInt(customTimeInput.value);
                if (customTime) {
                    setTimer(customTime);
                } else {
                    alert('请输入有效的时间');
                }
            });

            timerOptions.forEach(option => {
                option.addEventListener('click', () => {
                    const minutes = parseInt(option.getAttribute('data-minutes'));
                    setTimer(minutes);
                });
            });

            // 视图切换
            btnShowAll.addEventListener('click', () => {
                currentView = 'all';
                btnShowAll.classList.add('active');
                btnShowFavorites.classList.remove('active');
                renderStationList();
            });

            btnShowFavorites.addEventListener('click', () => {
                currentView = 'favorites';
                btnShowFavorites.classList.add('active');
                btnShowAll.classList.remove('active');
                renderStationList();
            });

            // M3U文件相关
            btnOpenM3u.addEventListener('click', () => {
                m3uSelectContainer.style.display = 'flex';
                m3uFileInput.value = '';
                m3uUrlInput.value = '';
                defaultLoadCheckbox.checked = false;
            });

            m3uCancelBtn.addEventListener('click', () => {
                m3uSelectContainer.style.display = 'none';
                m3uFileInput.value = '';
                m3uUrlInput.value = '';
                defaultLoadCheckbox.checked = false;
            });

            m3uConfirmBtn.addEventListener('click', function () {
                const file = m3uFileInput.files[0];
                const url = m3uUrlInput.value.trim();
                
                // 检查是否提供了文件或URL
                if (!file && !url) {
                    alert('请选择本地文件或输入在线M3U URL');
                    return;
                }
                
                // 保存是否默认加载的设置
                const shouldDefaultLoad = defaultLoadCheckbox.checked;
                
                if (url) {
                    // 处理在线M3U文件
                    loadOnlineM3U(url, shouldDefaultLoad);
                } else if (file) {
                    // 处理本地M3U文件
                    const reader = new FileReader();
                    reader.onload = function (e) {
                        processM3UContent(e.target.result, shouldDefaultLoad, false);
                    };
                    reader.readAsText(file);
                }
                
                m3uSelectContainer.style.display = 'none';
                // 重置输入
                m3uFileInput.value = '';
                m3uUrlInput.value = '';
            });

            // 搜索功能
            searchBox.addEventListener('input', (e) => {
                searchStations(e.target.value);
                clearSearch.style.display = e.target.value ? 'block' : 'none';
            });

            clearSearch.addEventListener('click', () => {
                searchBox.value = '';
                searchStations('');
                clearSearch.style.display = 'none';
            });

            // 音频事件监听
            audioPlayer.addEventListener('playing', () => {
                isPlaying = true;
                playIcon.innerHTML = '<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"></path>';
                statusElement.textContent = '正在播放';
            });

            audioPlayer.addEventListener('pause', () => {
                if (isPlaying) {
                    statusElement.textContent = '已暂停';
                }
            });

            audioPlayer.addEventListener('error', (error) => {
                console.error('音频错误:', error);
                statusElement.textContent = '播放出错，请尝试其他电台';
                isPlaying = false;
                playIcon.innerHTML = '<path d="M8 5v14l11-7z"></path>';
            });

            audioPlayer.addEventListener('ended', () => {
                statusElement.textContent = '播放结束';
                isPlaying = false;
                playIcon.innerHTML = '<path d="M8 5v14l11-7z"></path>';
            });

            // 初始化
            if (defaultM3uFile) {
                if (defaultM3uFile.type === 'url') {
                    loadOnlineM3U(defaultM3uFile.value, true);
                } else if (defaultM3uFile.type === 'file' && defaultM3uFile.value) {
                    processM3UContent(defaultM3uFile.value, true);
                }
            } else {
                // 解析内置电台数据
                stations = parseStations(radioData);
                renderStationList();
            }

            // 窗口关闭时清理
            window.addEventListener('beforeunload', () => {
                destroyHls();
            });
        });
    </script>
</body>

</html>